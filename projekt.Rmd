---
title: "Analiza kazalcev trajnostnega razvoja in kakovost življenja v Sloveniji"
author: "Ines Šilc"
output:
  html_document: default
  pdf_document:
    includes:
      in_header: lib/styles.sty
    latex_engine: xelatex
runtime: shiny
---

```{r setup, echo=FALSE, results='hide', message=FALSE}
# Če želimo nastaviti pisave v PDF-ju, odkomentiramo
# in sledimo navodilom v programu.
#source("fontconfig.r", encoding = "UTF-8")

# Uvoz vseh potrebnih knjižnic
source("lib/libraries.r", encoding = "UTF-8")
```

# Analiza kazalcev trajnostnega razvoja in kakovost življenja v Sloveniji

V projektu bom analizirala kazalce družbene blaginje v Sloveniji s štirih področji.

Prvo področje bo splošna ekonomska rast, tu se bom osredotočila predvsem na podatke o rasti bruto domačega proizvoda na prebivalca ter dohodek, pričakovana življenjska doba in izraba naravnih virov.

Drugo področje je Varnost, tu so vključeni:, kazalniki socialne zaščite (kjer se merijo izdatki za starost, invalidnost, brezposelnost...), stopnja brezposelnosti, število prebivalcev na enega zdravnika in delež obsojenih oseb.

Tretje področje je zdravje. Tu se bom osredotočila na podatke o procentu ljudi, ki živi v slabih stanovanjskih razmerah, število zdravih let ljudi pri rojstvu in kot procent cele življenjske dobe ter navedla podatke o nezadovoljstvu ljudi z slovenskim zdravstvenim sistemom (tu se bom osredotočila predvsem na podatke, ki so dostopni na Eurostatu, pod podatki zakaj ljudje niso prišli do želenega zdravljenja).

V zadnjem področju bom raziskovala porabo vode, odpadkov in avtomobilov po regijah.

Cilj: poskušala bom najti povezave med gospodarsko rastjo in izdatkov za zdravstvo in povezave med brezposelnostjo in številom obsojenih ljudi ter dostopom do zdravstvene oskrbe v Sloveniji.

# Obdelava, uvoz in čiščenje podatkov

```{r uvoz, echo=FALSE, message=FALSE}
source("uvoz/uvoz.r", encoding = "UTF-8")
```

Uvozila sem podatke o občinah v obliki CSV s statističnega urada in Eurostata, ter v obliki HTML
z Wikipedije. Podatke imam v štirih razpredelnicah v obliki *tidy data*.

1.`Leto` -spremenljivka: leto, katerega so bile narejene meritve
 - `Bruto domači proizvod` - meritev: rast bruto domačega proizvoda (število)
 - `Dohodek` - meritev: povprečni dohodek na člana gospodinjstva (število)
 - `Izdatki za zdravstveno varstvo` - meritev: delež dohodka, ki se nameni za zdravstveno varstvo
 - `Izdatki za invalidnost` - meritev: delež dohodka, ki se nameni za invalidnost
 - `Izdatki za smrt hranitelja` - meritev: delež dohodka, ki se nameni za smrt hranitelja
 - `Izdatki za starost` - meritev: delež dohodka, ki se nameni za starost
 - `Izdatki za družino` - meritev: delež dohodka, ki se nameni za družino
 - `Izdatki za brezposelnost` - meritev: delež dohodka, ki se nameni za brezposelnost
 - `Izdatki za nastanitev` - meritev: delež dohodka, ki se nameni za nastanitev
 
2.`Leto` - spremenljivka: leto, katerega so bile narejene meritve
 - `regija` - spremenljivka: regija, v kateri so bile narejene meritve
 - `Brezposelnost` - meritev: povprečna stopnja brezposelnosti
 - `Število prebivalcev na enega zdravnika` - meritev: število prebivalcev na enega zdravnika
 - `Delež obsojenih ljudi` - meritev: Delež obsojenih oseb med prebivalci regije po regiji stalnega     prebivališča
 
3. `Leto` - spremenljivka: leto, katerega so bile narejene meritve
 `Življenjska doba` - meritev: povprečna življenjska doba
 `Število zdravih let žensk pri rojstvu` - meritev: pričakovano število zdravih let žensk pri     rojstvu
 `Število zdravih let žensk` - meritev: pričakovano število zdravih let žensk skozi celotno       življenje
 `Število zdravih let moških pri rojstvu` - meritev: pričakovano število zdravih let moških pri rojstvu
 `Število zdravih let moških` - meritev: pričakovano število zdravih let moških skozi celotno življenje
 
4. `Leto`- spremenljivka: leto, katerega so bile narejene meritve
 -`Regija`- spremenljivka: regija, v kateri so bile narejene meritve
 -`Poraba vode, dobavljene iz javnega vodovoda` - meritev: Poraba vode, dobavljene iz javnega vodovoda, v gospodinjstvih na prebivalca (m3/prebivalca)
 - `Komunalni odpadki` - meritev: Komunalni odpadki, zbrani z javnim odvozom odpadkov na prebivalca (kilogram/prebivalca)
 - `Število vseh osebnih avtomobilov na 1.000 prebivalcev` - meritev: Število vseh osebnih avtomobilov na 1.000 prebivalcev (število/1.000 prebivalcev)

**Opomba**: da bi razpredelnica `obcine` res bila v obliki *tidy data*, bi morali odstraniti stolpec `gostota` (saj je izpeljan iz stolpcev `povrsina` in `prebivalci`), podatke o pokrajinah pa bi morali premakniti v drugo razpredelnico, saj nekatere občine pripadajo dvema pokrajinama. Podobno bi morali narediti tudi s stolpcem `odcepitev`.

Spodnji graf prikazuje porazdelitev števila naselij v občinah.

```{r histogram, echo=FALSE, message=FALSE, fig.align='center', fig.cap='Histogram števila naselij v občinah'}
ggplot(obcine, aes(x = naselja)) + geom_histogram() +
  ggtitle("Pogostost števila naselij") + xlab("Število naselij") + ylab("Število občin")
```

***

# Analiza in vizualizacija podatkov

```{r vizualizacija, echo=FALSE, message=FALSE, warning=FALSE}
source("vizualizacija/vizualizacija.r", encoding = "UTF-8")
```

Spodnji zemljevid prikazuje povprečno velikost družine za vsako občino.

```{r zemljevid, echo=FALSE, fig.align='center', fig.cap='Zemljevid povprečnega števila otrok v družini'}
ggplot() + geom_polygon(data = left_join(zemljevid, povprecja, by = c("OB_UIME" = "obcina")),
                        aes(x = long, y = lat, group = group, fill = povprecje)) +
  ggtitle("Povprečno število otrok v družini") + xlab("") + ylab("") +
  guides(fill = guide_colorbar(title = "Povprečje"))
```

***

# Napredna analiza podatkov

```{r analiza, echo=FALSE, message=FALSE}
source("analiza/analiza.r", encoding = "UTF-8")
```

Spodnji graf prikazuje povezavo med številom naselij in površino občine.

```{r graf, echo=FALSE, fig.align='center', fig.cap='Povezava med številom naselij in površino občine'}
ggplot(inner_join(obcine, data.frame(obcina = names(skupine),
                                     skupina = factor(skupine)), by = "obcina")
, aes(x = povrsina, y = naselja, color = skupina, size = prebivalci/1000)) + geom_point() +
  ggtitle("Število naselij glede na površino občine") +
  xlab(expression("Površina (km"^2 * ")")) + ylab("Št. naselij") +
  guides(color = guide_legend(title = "Skupina"),
         size = guide_legend(title = "Prebivalci (* 1000)"))
```

***

```{r shiny, echo = FALSE}
shinyAppDir("shiny", options=list(width="100%", height=600))
```
